pipeline {
    agent any

    parameters {
        string(name: 'NAME', description: 'Quel est votre nom ?')
        choice(name: 'MOIS', choices: ['Janvier', 'Décembre'], description: 'Choisissez le mois')
        choice(name: 'DAY', choices: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '30', '31'], description: 'Choose the day accordingly to the mois')
    }

    stages {
        stage('Objectifs du Mois') {
            steps {
                script {
                    def objectifs = []

                    switch(params.MOIS) {
                        case 'Janvier':
                            objectifs = [
                                booleanParam(name: "US01", description: "As-tu décrit ta journée au moins une fois cette semaine ?"),
                                booleanParam(name: "US02", description: "As-tu décrit ta journée trois fois cette semaine ?"),
                                booleanParam(name: "US03", description: "As-tu décrit toutes tes journées pendant un mois ?")
                            ]
                            break

                        case 'Décembre':
                            objectifs = [
                                booleanParam(name: "US34", description: "As-tu pratiqué 5 minutes de respiration consciente chaque matin ?"),
                                booleanParam(name: "US35", description: "As-tu testé différentes techniques de respiration ?"),
                                booleanParam(name: "US36", description: "As-tu utilisé la respiration consciente dans les moments de stress ?")
                            ]
                            break
                    }

                    if (objectifs) {
                        currentBuild.description = "Configuration des objectifs pour ${params.MOIS}"
                        def reponses = input message: "Complétez les objectifs pour ${params.MOIS}", parameters: objectifs
                        params = params + reponses
                    }
                }
            }
        }

        stage('Vérification des Objectifs') {
            steps {
                script {
                    def jour = params.DAY.toInteger()
                    def suffixe = (jour == 1) ? "er" : "e"

                    echo "Vérification des objectifs pour ${params.MOIS}, ${jour}${suffixe} jour..."

                    switch (params.MOIS) {
                        case 'Janvier':
                            if (params.US01?.toBoolean()) {
                                echo "Bravo ! Tu as décrit ta journée au moins une fois cette semaine."
                            } else {
                                echo "Pense à décrire ta journée au moins une fois cette semaine !"
                            }

                            if (params.US02?.toBoolean()) {
                                echo "Excellent travail en décrivant ta journée trois fois cette semaine !"
                            } else {
                                echo "Essaie de décrire ta journée trois fois cette semaine."
                            }

                            if (params.US03?.toBoolean()) {
                                echo "Félicitations ! Tu as décrit toutes tes journées pendant un mois."
                            } else {
                                echo "Continue à écrire chaque jour pour atteindre ton objectif mensuel."
                            }
                            break

                        case 'Décembre':
                            if (params.US34?.toBoolean()) {
                                echo "Bien joué ! Tu pratiques la respiration consciente chaque matin."
                            } else {
                                echo "Essaie de pratiquer 5 minutes de respiration consciente chaque matin."
                            }

                            if (params.US35?.toBoolean()) {
                                echo "Super ! Tu as testé différentes techniques de respiration."
                            } else {
                                echo "Découvre de nouvelles techniques de respiration."
                            }

                            if (params.US36?.toBoolean()) {
                                echo "Tu gères bien ton stress grâce à la respiration consciente."
                            } else {
                                echo "Utilise la respiration consciente pour mieux gérer ton stress."
                            }
                            break
                    }
                }
            }
        }
    }
}
